<div class="mainChatContainer">
    <div (click)="closeDialog()" class="dialogBackground" *ngIf="addMemberDialogOpen || channelEditionDialogOpen || showMembersDialogOpen">
    </div>

    <!-- ======================================== MAIN CHAT HEADER ========================================== -->
    @if(showChannel) {
        <!-- =========== TEMPLATE MAIN CHAT HEADER - CHANNELS ============= -->
        <div class="mainChatHeader">
            <div class="mainChatHeaderLeft" (click)="toggleDialog('channelEdition')">
                <div>&#35;</div>
                <div>{{channels[0].name}}</div>
                <div>
                    <mat-icon class="material-symbols-outlined" fontIcon="keyboard_arrow_down"></mat-icon>
                </div>
            </div>

            <!--========== Channel Edition/ Dialog ============-->
            <app-channel-edition-dialog *ngIf="channelEditionDialogOpen"></app-channel-edition-dialog>
            <!--=================================================-->

            <div class="mainChatHeaderRight">
                <div (click)="toggleDialog('showMembers')">
                    <div class="memberPhotos">
                        @for (member of channels[0].members; track $index) {
                            <div>
                                <img src="{{member.photo}}">
                            </div>
                        }
                    </div>
                    <div>{{membercount}}</div>
                </div>
                <div (click)="toggleDialog('addMember')">
                    <span class="material-symbols-outlined">person_add</span>
                </div>
            </div>

            <!--============== Show member Dialog ================-->
            <div class="showMembersDialog" *ngIf="showMembersDialogOpen" (click)="doNotClose($event)">
                <div>
                    <div>Mitglieder</div>
                    <div (click)="closeDialog()">
                        <span class="material-symbols-outlined">close</span>
                    </div>
                </div>
                <div class="usersListContainer">
                    <div class="usersListSubContainer">
                        <div class="userContainer">
                            <div class="userSubContainer">
                                <div>
                                    <img src="/assets/img/main-chat/member1.svg">
                                    <div></div>
                                </div>
                                <div>Sofia M端ller</div>    
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div>
                        <span class="material-symbols-outlined">person_add</span>
                    </div>
                    <div>Mitglieder hinzuf端gen</div>
                </div>
            </div>

            <!--========== Add member Dialog ============-->
            <div class="addMembersDialog" *ngIf="addMemberDialogOpen" (click)="doNotClose($event)">
                <div>
                    <div>Leute hinzuf端gen</div>
                    <div (click)="closeDialog()">
                        <span class="material-symbols-outlined">close</span>
                    </div>
                </div>
                <div>#  {{channels[0].name}}</div>
                <div>
                    <form>
                        <mat-form-field class="example-chip-list">
                          <mat-chip-grid #chipGrid aria-label="Fruit selection">
                            @for (fruit of fruits; track fruit) {
                              <mat-chip-row (removed)="remove(fruit)">
                                {{fruit}}
                                <button matChipRemove [attr.aria-label]="'remove ' + fruit">
                                    <span class="material-symbols-outlined">cancel</span>                                
                                </button>
                              </mat-chip-row>
                            }
                          </mat-chip-grid>
                          <input placeholder="New Fruit..." #fruitInput [formControl]="fruitCtrl"
                            [matChipInputFor]="chipGrid" [matAutocomplete]="auto"
                            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                            (matChipInputTokenEnd)="add($event)"/>
                          <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)">
                            @for (fruit of filteredFruits | async; track fruit) {
                              <mat-option [value]="fruit">{{fruit}}</mat-option>
                            }
                          </mat-autocomplete>
                        </mat-form-field>
                      </form>
                </div>
                <div>
                    <button (click)="addMember()" >Hinzuf端gen</button>
                </div>
            </div>
            <!--=================================================-->

        </div>
        <!-- ================================================== -->
    } @else {
        <!-- =========== TEMPLATE MAIN CHAT HEADER - DM ============= -->
        <div class="mainChatHeader">
            <div class="mainChatHeaderLeft">
                <div class="userImage">
                    <img src="/assets/img/main-chat/member2.svg">
                    <div class="onlineStatus"
                    [ngClass]="{
                      online: users[1].onlineStatus === 'active',
                      idle: users[2].onlineStatus === 'idle',
                      busy: users[3].onlineStatus === 'busy',
                      away: users[0].onlineStatus === 'away'
                    }"></div>
                </div>
                <div>{{users[1].name}} {{users[1].surname}}</div>
            </div>
        </div>
        <!-- ========================================================== -->
    }

    <!-- ======================================== MAIN CHAT MESSAGES ========================================== -->
    <div class="mainChatMessages">
        <div class="mainChatMessagesSubContainer">
            @if(showChannel) {
                <!-- =========== Template main chat beginning - Channel ============= -->
                <div class="beginningOfChannel">
                    <div>
                        <div>&#35;</div>
                        <div>{{channels[0].name}}</div>
                    </div>
                    <div>
                        Du hast den Channel heute erstellt. Das ist der Anfang des Channels <span style="color: rgba(83, 90, 241, 1)">#{{channels[0].name}}</span>
                    </div>
                </div>
                <!-- ================================================================ -->
            } @else {
                <!-- =========== Template main chat beginning - DM ============= -->
                <div class="beginningOfChannel">
                    <div>
                        <div>
                            <img [src]="channels[0].members[0].photo">
                        </div>
                        <div>{{channels[0].members[0].name}}</div>
                    </div>
                    <div>
                        Diese Unterhaltung findet nur zwischen <span style="color: rgba(83, 90, 241, 1)">&#64;{{channels[0].members[0].name}} {{channels[0].members[0].surname}}</span> und dir statt.
                    </div>
                </div>
                <!-- ================================================================ -->
            }

            <!-- =================== Time separator ===================== -->
            <div class="timeSeparator">
                <div>
                    <div>Heute</div>
                </div>
            </div>
            
            @if(channels[0].messages.length !== 0) {

                <!-- ========================= Template Other Messages ========================= -->
                <div class="messageContainer">
                    <div class="messageProfileIcon">
                        <img src="/assets/img/main-chat/member1.svg">
                    </div>
                    <div class="mainMessage">
                        <div>
                            <div>Noah Braun</div>
                            <div>14:25 Uhr</div>
                        </div>
                        <div>
                            Welche Version ist aktuell von Angular?
                        </div>
                        <div class="mainMessageThreads">
                            <div>2 Antworten</div>
                            <div>Letzte Antwort 14:56</div>
                        </div>
                        <div class="mainMessageReactions">

                        </div>
                    </div>
                </div>
                <!-- ============================================================================ -->

                <!-- ========================= Template Own Messages ========================= -->
                <div class="messageContainer messageContainerOwn">
                    <div class="messageProfileIcon">
                        <img src="/assets/img/main-chat/member1.svg">
                    </div>
                    <div class="mainMessage mainMessageOwn">
                        <div>
                            <div>Noah Braun</div>
                            <div>14:25 Uhr</div>
                        </div>
                        <div>
                            Welche Version ist aktuell von Angular?
                        </div>
                        <div class="mainMessageThreads">
                            <div>2 Antworten</div>
                            <div>Letzte Antwort 14:56</div>
                        </div>
                        <div class="mainMessageReactions">

                        </div>
                    </div>
                </div>
                <!-- ============================================================================ -->
            }

        </div>
    </div>

    <div class="mainChatInput">
        <div class="mainChatInputSubContainer">
            <textarea [(ngModel)]="textArea" name="textarea" placeholder="Nachricht an #{{channels[0].name}}"></textarea>
           <div>
                <div>
                    <button></button>
                        <img src="/assets/img/main-chat/separatingLine.svg">
                        
                    <button></button>

<!--                <img src="../../../assets/img/main-chat/addDefault.svg">
                    <img src="../../../assets/img/main-chat/separatingLine.svg">
                    <img src="../../../assets/img/main-chat/smileDefault.svg">
                    <img src="../../../assets/img/main-chat/tagDefault.svg">
 -->                </div>
                <div>
                    <img src="/assets/img/main-chat/sendIconDefault.svg">
                </div>
            </div>
        </div>
    </div>
</div>
